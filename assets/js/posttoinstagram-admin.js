!function(a){a(function(){var f,h,b=a(".posttoinstagram-demo-form"),c=a(".posttoinstagram-demo-preview"),d=a("iframe",c),e=a(".posttoinstagram-demo-shortcode textarea"),g={},i=function(){a("input[type=text], input[type=checkbox]:not([name=responsive]), input[type=hidden], select",b).each(function(){j(a(this))})},j=function(a){var b=a.attr("name"),c=a.val();"width"!=b&&"height"!=b||new RegExp("px|%|auto").test(c)||(c+="px"),a.is("[type=checkbox]")&&(c=a.prop("checked").toString()),a.is(".posttoinstagram-colorpicker")&&(c=a.wpColorPicker("color")),g[b]=c},k=function(b){b&&j(b);var i="[posttoinstagram";for(var k in g)g[k]&&"api"!=k&&(i+=" "+k+'="'+g[k]+'"');i+="]",e.val(i).css("height","auto").css("height",e[0].scrollHeight+4),clearTimeout(h),h=setTimeout(function(){c.css({width:g.width,height:g.height}),d.attr("src",f+"?"+a.param(g))},500)};d.length&&(f=d.attr("src").split("?")[0],a("input[type=text]",b).not(".posttoinstagram-colorpicker").on("keyup change",function(){k(a(this))}),a("input[type=checkbox]:not([name=responsive])",b).on("click",function(){k(a(this))}),a("select",b).on("change",function(){k(a(this))})),a.fn.wpColorPicker&&a(".posttoinstagram-colorpicker").each(function(){var b=a(this);b.wpColorPicker({change:function(){k(b)},defaultColor:b.val(),palettes:!1})}),i(),e.on("click",function(){e.select()});var m,l=a(".posttoinstagram-demo-field-width input",b);a(".posttoinstagram-demo-field-responsive input[type=checkbox]",b).on("click",function(){a(this).prop("checked")?(m=l.val(),l.val("auto").trigger("change").prop("disabled",!0)):l.prop("disabled",!1).val(m).trigger("change")});var n=a(".posttoinstagram-admin-activation"),o=a("form",n),p=a(".posttoinstagram-admin-activation-form-purchase-code-input",o),q=a(".posttoinstagram-admin-activation-form-activated-input",o),r=a(".posttoinstagram-admin-activation-form-message-success",o),s=a(".posttoinstagram-admin-activation-form-message-error",o),t=a(".posttoinstagram-admin-activation-form-message-fail",o),u=a(".posttoinstagram-admin-activation-version-check-button"),v=function(b,c){a.post(ajaxurl,{action:"PTI_POSTTOINSTAGRAM_update_activation_data",purchase_code:b,activated:c,nonce:o.attr("data-nonce")})};o.submit(function(b){b.preventDefault(),b.stopPropagation();var c=o.attr("data-activation-url"),d=o.attr("data-activation-slug"),e=o.attr("data-activation-version"),f=p.val(),g=q.val();a.ajax({url:c,dataType:"jsonp",data:{action:"purchase_code",slug:d,purchase_code:f,version:e}}).done(function(a){a.verification?(g=!!a.verification.valid,q.val(g),a.verification.valid?(n.removeClass("posttoinstagram-admin-activation-invalid").addClass("posttoinstagram-admin-activated"),s.hide(),t.hide(),r.show(),u.trigger("click")):(n.removeClass("posttoinstagram-admin-activated").toggleClass("posttoinstagram-admin-activation-invalid",!!f),r.hide(),t.hide(),s.toggle(!!f))):g=!1,v(f,g)}).fail(function(){n.removeClass("posttoinstagram-admin-activated").addClass("posttoinstagram-admin-activation-invalid"),q.val(!1),r.hide(),s.hide(),t.show(),v(f,!1)})})})}(jQuery);